local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")

local tailParts = {}
local segmentCount = 16
local tailLength = 0.6

-- Create tail parts
for i = 1, segmentCount do
	local part = Instance.new("Part")
	part.Size = Vector3.new(0.4 + i * 0.1, 0.4 + i * 0.1, 0.4 + i * 0.1)
	part.Shape = Enum.PartType.Block
	part.Material = Enum.Material.Neon
	part.Anchored = false
	part.CanCollide = false
	part.Color = Color3.fromHSV(i / segmentCount, 1, 1)
	part.CFrame = hrp.CFrame * CFrame.new(0, -1, -i * tailLength)
	part.Parent = workspace
	tailParts[i] = part

	if i > 1 then
		local constraint = Instance.new("BallSocketConstraint")
		constraint.Attachment0 = Instance.new("Attachment", tailParts[i - 1])
		constraint.Attachment1 = Instance.new("Attachment", part)
		constraint.Parent = part
	end
end

-- WHITE PASTEL SPINNER PART
local pastel = Instance.new("Part")
pastel.Shape = Enum.PartType.Block
pastel.Size = Vector3.new(1.2, 1.2, 1.2)
pastel.Material = Enum.Material.Neon
pastel.Anchored = false
pastel.CanCollide = false
pastel.Color = Color3.fromRGB(255, 255, 255)
pastel.Parent = workspace

local pastelAttachment = Instance.new("Attachment", tailParts[#tailParts])
local pastelFollowAttachment = Instance.new("Attachment", pastel)

local alignPos = Instance.new("AlignPosition")
alignPos.Attachment0 = pastelFollowAttachment
alignPos.Attachment1 = pastelAttachment
alignPos.Position = Vector3.new(0, 0, 5) -- offset it behind the tip
alignPos.Responsiveness = 50
alignPos.RigidityEnabled = true
alignPos.Parent = pastel

-- Rotate pastel cube passively
RunService.RenderStepped:Connect(function(dt)
	pastel.CFrame = pastel.CFrame * CFrame.Angles(0, math.rad(60 * dt), 0)
	local h = (tick() * 0.25) % 1
	pastel.Color = Color3.fromHSV(h, 0.7, 1)
end)

-- WOBBLE BEHAVIOR
local velocity = Vector3.zero
RunService.Heartbeat:Connect(function(dt)
	local currentPos = hrp.Position
	local moveVec = (hrp.Velocity).Magnitude

	for i, part in ipairs(tailParts) do
		local distance = (segmentCount - i) * tailLength
		local targetPos = hrp.Position - hrp.CFrame.LookVector * distance
		local force = Instance.new("BodyVelocity")
		force.MaxForce = Vector3.new(1e5, 1e5, 1e5)
		force.Velocity = (targetPos - part.Position) * 3
		force.P = 3000
		force.Parent = part

		game.Debris:AddItem(force, 0.05)
	end
end)
