local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

local active = false
local startTime = 0
local highlights = {}

-- Highlight all other players
local function highlightPlayers()
    for _, otherPlayer in pairs(Players:GetPlayers()) do
        if otherPlayer ~= player and otherPlayer.Character then
            local highlight = Instance.new("Highlight")
            highlight.FillColor = Color3.new(0, 1, 0)
            highlight.OutlineColor = Color3.new(0, 1, 0)
            highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
            highlight.Adornee = otherPlayer.Character
            highlight.Parent = otherPlayer.Character
            highlights[otherPlayer] = highlight
        end
    end
end

-- Remove all highlights
local function removeHighlights()
    for _, highlight in pairs(highlights) do
        if highlight then
            highlight:Destroy()
        end
    end
    highlights = {}
end

-- Handle E key press
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.E and not active then
        active = true
        startTime = tick()
        highlightPlayers()

        task.delay(10, function()
            if active then
                removeHighlights()
                active = false
            end
        end)
    end
end)
