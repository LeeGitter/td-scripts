local Players = game:GetService("Players")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "FNFGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui
screenGui.Enabled = true

-- GUI box setup
local boxSize = UDim2.new(0, 400, 0, 220)

local guiBox = Instance.new("Frame")
guiBox.Name = "GuiBox"
guiBox.Size = boxSize
guiBox.AnchorPoint = Vector2.new(0.5, 0.5)
guiBox.Position = UDim2.new(0.5, 0, 0.5, 0)
guiBox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
guiBox.BorderSizePixel = 0
guiBox.Parent = screenGui

local dragBar = Instance.new("Frame")
dragBar.Name = "DragBar"
dragBar.Size = UDim2.new(1, 0, 0, 30)
dragBar.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
dragBar.BorderSizePixel = 0
dragBar.Parent = guiBox

local dragText = Instance.new("TextLabel")
dragText.Text = "FNF Chart Loader"
dragText.Font = Enum.Font.SourceSansBold
dragText.TextSize = 18
dragText.TextColor3 = Color3.new(1, 1, 1)
dragText.BackgroundTransparency = 1
dragText.Size = UDim2.new(1, 0, 1, 0)
dragText.Parent = dragBar

local jsonInput = Instance.new("TextBox")
jsonInput.Name = "JSONInput"
jsonInput.Size = UDim2.new(1, -20, 0, 140)
jsonInput.Position = UDim2.new(0, 10, 0, 40)
jsonInput.TextWrapped = true
jsonInput.MultiLine = true
jsonInput.ClearTextOnFocus = false
jsonInput.PlaceholderText = "Paste full FNF JSON here"
jsonInput.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
jsonInput.TextColor3 = Color3.new(1, 1, 1)
jsonInput.Font = Enum.Font.SourceSans
jsonInput.TextSize = 14
jsonInput.Parent = guiBox

local loadButton = Instance.new("TextButton")
loadButton.Name = "LoadButton"
loadButton.Size = UDim2.new(0, 100, 0, 30)
loadButton.Position = UDim2.new(0.5, -50, 1, -40)
loadButton.Text = "âœ” Load Song"
loadButton.BackgroundColor3 = Color3.fromRGB(70, 130, 70)
loadButton.TextColor3 = Color3.new(1, 1, 1)
loadButton.Font = Enum.Font.SourceSansBold
loadButton.TextSize = 18
loadButton.Parent = guiBox

-- Loading label (hidden initially)
local loadingLabel = Instance.new("TextLabel")
loadingLabel.Text = "Loading..."
loadingLabel.Size = UDim2.new(0, 100, 0, 30)
loadingLabel.Position = UDim2.new(0.5, -50, 1, -80)
loadingLabel.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
loadingLabel.TextColor3 = Color3.new(1, 1, 1)
loadingLabel.Font = Enum.Font.SourceSansBold
loadingLabel.TextSize = 18
loadingLabel.Visible = false
loadingLabel.Parent = guiBox

-- Function to drag GUI
local dragging = false
local dragStart = nil
local startPos = nil

dragBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = guiBox.Position

        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

dragBar.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        guiBox.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end
end)

-- Just show the GUI box immediately
guiBox.Visible = true
